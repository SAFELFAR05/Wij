<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DramaBox - Detail Drama</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #141414; color: white; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        .hero-gradient { background: linear-gradient(to top, #141414 0%, rgba(20,20,20,0) 50%, rgba(20,20,20,0.5) 100%); }
    </style>
</head>
<body>
    <nav class="fixed top-0 w-full z-50 p-4 bg-gradient-to-b from-black/80 to-transparent">
        <a href="/" class="flex items-center space-x-2 text-white hover:text-gray-300 transition">
            <i class="fas fa-arrow-left text-2xl"></i>
            <span class="text-xl font-bold">Kembali</span>
        </a>
    </nav>

    <div id="detail-content" class="min-h-screen">
        <div class="flex items-center justify-center h-screen">
            <i class="fas fa-spinner fa-spin text-5xl text-red-600"></i>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const bookId = urlParams.get('id');

        async function fetchDetail() {
            if (!bookId) return window.location.href = '/';
            
            try {
                const response = await fetch(`/api/dramas/${bookId}`);
                const result = await response.json();
                
                if (result.success) {
                    const d = result.data.drama;
                    const chapters = result.data.chapters;
                    
                    document.title = `${d.bookName} - DramaBox`;
                    
                    document.getElementById('detail-content').innerHTML = `
                        <div class="relative h-[60vh] md:h-[80vh]">
                            <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('${d.cover}')"></div>
                            <div class="hero-gradient absolute inset-0"></div>
                            <div class="absolute bottom-12 left-4 md:left-12 max-w-2xl">
                                <h1 class="text-4xl md:text-6xl font-bold mb-6">${d.bookName}</h1>
                                <div class="flex space-x-4 mb-8">
                                    <a href="/player.html?bookId=${d.bookId}&episode=1" class="bg-white text-black px-10 py-3 rounded font-bold hover:bg-white/80 transition flex items-center space-x-2">
                                        <i class="fas fa-play"></i> <span>Putar Sekarang</span>
                                    </a>
                                    <button class="bg-gray-500/50 text-white p-3 rounded-full hover:bg-gray-500/30 transition">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <div class="flex items-center space-x-4 text-green-500 font-bold">
                                    <span>98% Match</span>
                                    <span class="text-gray-400 font-normal">Chapters: ${d.chapterCount}</span>
                                    <span class="border border-gray-600 px-1 text-xs text-gray-400 font-normal">HD</span>
                                </div>
                            </div>
                        </div>

                        <div class="px-4 md:px-12 py-12">
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                                <div class="lg:col-span-2">
                                    <p class="text-xl leading-relaxed text-gray-200 mb-12">${d.introduction}</p>
                                    
                                    <h3 class="text-2xl font-bold mb-6 border-b border-gray-800 pb-2">Daftar Episode</h3>
                                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
                                        ${chapters.map(ch => `
                                            <a href="/player.html?bookId=${d.bookId}&episode=${ch.index + 1}" 
                                               class="bg-[#2f2f2f] hover:bg-[#3f3f3f] p-4 rounded text-center transition border border-transparent hover:border-red-600">
                                                Episode ${ch.index + 1}
                                            </a>
                                        `).join('')}
                                    </div>
                                </div>
                                
                                <div class="space-y-6 text-sm">
                                    <div>
                                        <span class="text-gray-500 block mb-1">Pemeran:</span>
                                        <p class="text-gray-200">${d.performerList.map(p => p.performerName).join(', ')}</p>
                                    </div>
                                    <div>
                                        <span class="text-gray-500 block mb-1">Genre:</span>
                                        <p class="text-gray-200">${d.typeTwoName}</p>
                                    </div>
                                    <div>
                                        <span class="text-gray-500 block mb-1">Tag:</span>
                                        <div class="flex flex-wrap gap-2 mt-2">
                                            ${d.tags.map(tag => `<span class="bg-[#2f2f2f] px-2 py-1 rounded text-xs text-gray-400">${tag}</span>`).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            } catch (err) {
                console.error('Fetch detail failed:', err);
                document.getElementById('detail-content').innerHTML = '<div class="p-20 text-center text-red-500">Gagal memuat detail drama.</div>';
            }
        }

        fetchDetail();
    </script>
</body>
</html>
